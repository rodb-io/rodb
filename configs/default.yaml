# TODO add the default objects in the default config method
# TODO manually fill the config structs and default values from yaml maps?
# TODO test the configuration validators
# TODO completely test the configuration against the rootConfig (and remove comments about checking at runtime)
# TODO test the constructors
# TODO performance analysis
parsers:
  defaultInteger:
    integer:
      ignoreCharacters: ", .â‚¬$"
  defaultFloat:
    float:
      decimalSeparator: "."
      ignoreCharacters: ", "
  defaultBoolean:
    boolean:
      trueValues: ["true", "1", "yes", "TRUE", "YES"]
      falseValues: ["false", "0", "no", "FALSE", "NO", ""]
  defaultString:
    string:
      convertFromCharset: ""
sources:
  defaultSource:
    # TODO warning if another process changes a file while opened with an index
    filesystem:
      path: ./
  # TODO S3 source
  # TODO http source
inputs:
  defaultInput:
    csv:
      # TODO setting to autodetect columns if there is a title row?
      source: defaultSource
      path: ./dummy.csv
      ignoreFirstRow: true
      delimiter: ","
      columns:
        - name: id
          parser: defaultInteger
        - name: name
          parser: defaultString
        - name: number
          parser: defaultFloat
        - name: bool
          parser: defaultBoolean
  # TODO xml input
  # TODO json input
  # TODO json rows input
  # TODO database source/input?
indexes:
  defaultIndex:
    memoryMap:
      # TODO show indexing progress
      input: defaultInput
      columns:
        - id
        - name
  # TODO stored indexes (bson or msgpack?)
  # TODO bleve index
  # TODO lucene index
services:
  defaultService:
    http:
      # TODO add health-checks
      listen: ":80"
      # TODO errors type
  # TODO https service
  # TODO authentication
  # TODO websocket service
  # TODO console (stin pipeable?) service
outputs:
  # autogenerated API doc output?
  defaultGraphqlOutput:
    graphql:
      services:
        - defaultService
      endpoint: "/"
      # TODO configuration
  defaultJsonArrayOutput:
    jsonArray:
      services:
        - defaultService
      endpoint: "/dummies"
      limit:
        default: 100
        max: 1000
        param: "limit"
      offset:
        param: "offset"
      search:
        id:
          index: defaultIndex
        name:
          index: defaultIndex
        # TODO handle the filters even without index (basic search)
        # TODO sorting
  defaultJsonObjectOutput:
    jsonObject:
      input: defaultInput
      index: defaultIndex
      services:
        - defaultService
      endpoint: "/dummies/?"
      relationships:
        mySubProperty:
          input: defaultInput
          index: defaultIndex
          isArray: false
          match:
            - parentColumn: id
              childColumn: id
          relationships:
            mySubSubProperty:
              input: defaultInput
              index: defaultIndex
              isArray: true
              match:
                - parentColumn: id
                  childColumn: id
          # TODO relationship sorting?
      parameters:
        - column: id
          parser: integer
